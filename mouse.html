<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>

    <script>
        var canvas;
        var grctx;

        var xPosInfo = null;
        var yPosInfo = null;
        var trakInfo = null;

        var tracking = false;

        var pos = {
            x: 0,
            y: 0
        };

        function randomColour() {
            var s = "0123456789ABCDEF";
            var c = "#";
            for (var i = 0; i < 6; i++) {
                c += s[Math.ceil(Math.random() * 15)]
            }
            return c
        }

        var items = [];

        window.onload = function myfunction() {
            canvas = document.getElementById('cw');

            pos.x = canvas.width / 2;
            pos.y = canvas.height / 2;

            canvas.onmousemove = function( e ) {

                if ( tracking ) {
                    pos.x = e.offsetX;
                    pos.y = e.offsetY;
                }
            }

            window.onclick = function( e ) {
                tracking = ! tracking;
            }

            xPosInfo = document.getElementById( "x" );
            yPosInfo = document.getElementById( "y" );
            trakInfo = document.getElementById( "trak" );

            grctx = canvas.getContext('2d');

            resize();

            anim();
        }

        window.onresize = function () {
            resize();
        }

        function resize() {
            // canvas.height = window.innerHeight;
            // canvas.width = window.innerWidth;

            const xScale = canvas.width / window.innerWidth;
            const yScale = canvas.height / window.innerHeight;

            console.info( `xs = ${xScale}, ys = ${yScale}` );

            for (var i = 0; i < 50; i++) {

                const spin = ( Math.random() * ( 2 + i / 30.0 ) + 0.25 ) / 180 * Math.PI * ( Math.random() > 0.5 ? 1.0 : -1.0 );

                items[i] = new ob(
                    pos.x,
                    pos.y,
                    Math.random() * 2.5 + 1.5,
                    randomColour(),
                    // Math.random() * ( 100 + 2 * i ) + 2 * i,
                    1.3 * ( 50 + 2 * i ) + 1.4 * i,
                    spin
                );
            }
        }

        function ob(x, y, r, col, o, spin) {
            this.x = x;
            this.y = y;
            this.r = r;
            this.col = col;
            this.theta = Math.random() * Math.PI * 2;
            this.spin = spin;
            this.o = o;
            this.t = Math.random() * 250;
            this.t = this.o;


            this.x = x + Math.cos(this.theta) * this.t;
            this.y = y + Math.sin(this.theta) * this.t;

            this.draw = function () {
                const ls = {
                    x: this.x,
                    y: this.y
                };

                this.theta += this.spin;

                this.x = pos.x + Math.cos(this.theta) * this.t;
                this.y = pos.y + Math.sin(this.theta) * this.t;

                grctx.beginPath();
                grctx.lineWidth = this.r;
                grctx.strokeStyle = this.col;
                grctx.moveTo(ls.x, ls.y);
                grctx.lineTo(this.x, this.y);
                grctx.stroke();
                grctx.closePath();

            }
        }

        function anim() {
            requestAnimationFrame(anim);

            grctx.fillStyle = "rgba(0,0,0,0.07)";
            grctx.fillRect(0, 0, canvas.width, canvas.height);

            xPosInfo.value = pos.x;
            yPosInfo.value = pos.y;
            trakInfo.value = tracking ? "ON" : "OFF";

            items.forEach(function (e, i) {
                e.draw();
            });

        }
    </script>

    <style>
        body {
            background-color: rgba(0, 0, 0, 0.05);
        }

        #cdiv {
            /* width: 800px;
            height: 800px; */
        }

        input {
            font-weight: bolder;
            color: darkblue;
        }

        #cw {
            /* width: 800;
            height: 800;
            z-index: -1; */
            display: block;
        }
    </style>
</head>

<body>
    <h1>Spinning ...</h1>
    <div>
        <label> X= </label>
        <input id="x" type="test" disabled="true" placeholder="X position...">

        <label> Y= </label>
        <input id="y" type="test" disabled="true" placeholder="Y position...">

        <label> Tracking= </label>
        <input id="trak" type="test" disabled="true" placeholder="Tracking Mouse?">
    </div>

    <h1>Canvas</h1>

    <div id="cdiv">
        <canvas id="cw" height="800" width="800"></canvas>
    </div>

    <h1>Other ...</h1>
</body>

</html>